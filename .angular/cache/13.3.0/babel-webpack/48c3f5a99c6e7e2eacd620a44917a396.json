{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { finalize } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/auth\";\nimport * as i2 from \"@angular/fire/compat/firestore\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"../core/auth.service\";\nimport * as i5 from \"@angular/fire/compat/storage\";\n\nfunction ProfileComponent_div_0_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 33)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.error);\n  }\n}\n\nfunction ProfileComponent_div_0_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"img\", 34);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const srcUrl_r7 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", srcUrl_r7, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction ProfileComponent_div_0_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"img\", 35);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ProfileComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵtemplate(1, ProfileComponent_div_0_div_1_Template, 3, 1, \"div\", 2);\n    i0.ɵɵelementStart(2, \"div\", 3)(3, \"div\", 4);\n    i0.ɵɵtemplate(4, ProfileComponent_div_0_div_4_Template, 2, 1, \"div\", 5);\n    i0.ɵɵpipe(5, \"async\");\n    i0.ɵɵtemplate(6, ProfileComponent_div_0_div_6_Template, 2, 0, \"div\", 5);\n    i0.ɵɵpipe(7, \"async\");\n    i0.ɵɵelementStart(8, \"input\", 6, 7);\n    i0.ɵɵlistener(\"change\", function ProfileComponent_div_0_Template_input_change_8_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.fileChange($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"progress\", 8);\n    i0.ɵɵpipe(11, \"async\");\n    i0.ɵɵelementStart(12, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function ProfileComponent_div_0_Template_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r9);\n\n      const _r5 = i0.ɵɵreference(9);\n\n      return _r5.click();\n    });\n    i0.ɵɵtext(13, \" Upload Photo \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"form\", 10, 11);\n    i0.ɵɵlistener(\"submit\", function ProfileComponent_div_0_Template_form_submit_14_listener() {\n      i0.ɵɵrestoreView(_r9);\n\n      const _r6 = i0.ɵɵreference(15);\n\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.onSubmit(_r6);\n    });\n    i0.ɵɵelementStart(16, \"div\", 12)(17, \"div\", 13)(18, \"label\");\n    i0.ɵɵtext(19, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(20, \"input\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\", 13)(22, \"label\");\n    i0.ɵɵtext(23, \"Email\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(24, \"input\", 15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(25, \"div\", 12)(26, \"div\", 16)(27, \"label\");\n    i0.ɵɵtext(28, \"Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(29, \"input\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"div\", 18)(31, \"label\");\n    i0.ɵɵtext(32, \"City\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(33, \"input\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"div\", 20)(35, \"label\");\n    i0.ɵɵtext(36, \"State\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(37, \"input\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(38, \"div\", 22)(39, \"label\");\n    i0.ɵɵtext(40, \"Zip\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(41, \"input\", 23);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(42, \"div\", 24)(43, \"div\", 25)(44, \"label\");\n    i0.ɵɵtext(45, \"Phone\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(46, \"input\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(47, \"div\", 25)(48, \"label\");\n    i0.ɵɵtext(49, \"Specialty\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(50, \"select\", 27)(51, \"option\", 28);\n    i0.ɵɵtext(52, \"Field Agent\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(53, \"option\", 29);\n    i0.ɵɵtext(54, \"Covert Operations\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(55, \"option\", 30);\n    i0.ɵɵtext(56, \"Intelligence Officer\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(57, \"div\", 25)(58, \"label\");\n    i0.ɵɵtext(59, \"ip\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(60, \"input\", 31);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(61, \"button\", 32);\n    i0.ɵɵtext(62, \"Submit\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const userProfile_r1 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.error);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(5, 15, ctx_r0.downloadURL));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !i0.ɵɵpipeBind1(7, 17, ctx_r0.downloadURL));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"value\", i0.ɵɵpipeBind1(11, 19, ctx_r0.uploadProgress));\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"loading\", ctx_r0.loading);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.name);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.email);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.address);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.city);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.state);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.zip);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.phone);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.specialty);\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"ngModel\", userProfile_r1.ip);\n  }\n}\n\nexport let ProfileComponent = /*#__PURE__*/(() => {\n  class ProfileComponent {\n    constructor(afAuth, afs, route, auth, afStorage) {\n      this.afAuth = afAuth;\n      this.afs = afs;\n      this.route = route;\n      this.auth = auth;\n      this.afStorage = afStorage;\n      this.loading = false;\n      this.uid = this.route.snapshot.paramMap.get('id');\n      this.downloadURL = this.afStorage.ref(`users/${this.uid}/profile-image`).getDownloadURL();\n    }\n\n    ngOnInit() {\n      this.itemDoc = this.afs.doc(`users/${this.uid}`);\n      this.item = this.itemDoc.valueChanges();\n    }\n\n    onSubmit(ngForm) {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.loading = true;\n        const {\n          email,\n          name,\n          address,\n          city,\n          state,\n          zip,\n          ip,\n          phone,\n          specialty\n        } = ngForm.form.getRawValue();\n        const userProfile = {\n          uid: this.uid,\n          email,\n          name,\n          address,\n          city,\n          state,\n          zip,\n          ip,\n          phone,\n          specialty\n        };\n\n        try {\n          yield this.auth.updateUserDocument(userProfile);\n        } catch (error) {\n          console.log(error.message);\n          this.error = error.message;\n        }\n\n        this.loading = false;\n      });\n    }\n\n    fileChange(event) {\n      this.downloadURL = null;\n      this.error = null; // get the file\n\n      const file = event.target.files[0]; // create the file refrence\n\n      const filePath = `users/${this.uid}/profile-image`;\n      const fileRef = this.afStorage.ref(filePath); // upload and store the task\n\n      const task = this.afStorage.upload(filePath, file);\n      task.catch(error => this.error = error.message); // observer percentage changes\n\n      this.uploadProgress = task.percentageChanges(); // get notified when the download URL is avaialbe\n\n      task.snapshotChanges().pipe(finalize(() => {\n        this.downloadURL = fileRef.getDownloadURL();\n      })).subscribe();\n    }\n\n  }\n\n  ProfileComponent.ɵfac = function ProfileComponent_Factory(t) {\n    return new (t || ProfileComponent)(i0.ɵɵdirectiveInject(i1.AngularFireAuth), i0.ɵɵdirectiveInject(i2.AngularFirestore), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i4.AuthService), i0.ɵɵdirectiveInject(i5.AngularFireStorage));\n  };\n\n  ProfileComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProfileComponent,\n    selectors: [[\"app-profile\"]],\n    decls: 2,\n    vars: 3,\n    consts: [[\"class\", \"add-form-container\", 4, \"ngIf\"], [1, \"add-form-container\"], [\"class\", \"ui negative message\", 4, \"ngIf\"], [1, \"ui\", \"grid\", \"stackable\"], [1, \"four\", \"wide\", \"column\", \"profile-image\"], [4, \"ngIf\"], [\"type\", \"file\", \"accept\", \".png,.jpg\", 1, \"file-input\", 3, \"change\"], [\"fileInput\", \"\"], [\"max\", \"100\", 3, \"value\"], [1, \"ui\", \"grey\", \"button\", \"upload-button\", 3, \"click\"], [1, \"ui\", \"big\", \"form\", \"twelve\", \"wide\", \"column\", 3, \"submit\"], [\"profileForm\", \"ngForm\"], [1, \"fields\"], [1, \"eight\", \"wide\", \"field\"], [\"type\", \"text\", \"name\", \"name\", 3, \"ngModel\"], [\"type\", \"text\", \"name\", \"email\", \"disabled\", \"\", 3, \"ngModel\"], [1, \"six\", \"wide\", \"field\"], [\"type\", \"text\", \"name\", \"address\", 3, \"ngModel\"], [1, \"five\", \"wide\", \"field\"], [\"type\", \"text\", \"name\", \"city\", 3, \"ngModel\"], [1, \"two\", \"wide\", \"field\"], [\"type\", \"text\", \"name\", \"state\", 3, \"ngModel\"], [1, \"three\", \"wide\", \"field\"], [\"type\", \"text\", \"name\", \"zip\", 3, \"ngModel\"], [1, \"equal\", \"width\", \"fields\"], [1, \"field\"], [\"type\", \"text\", \"name\", \"phone\", 3, \"ngModel\"], [\"name\", \"specialty\", 1, \"specialty\", 3, \"ngModel\"], [\"value\", \"field agent\"], [\"value\", \"covert operations\"], [\"value\", \"intelligence officer\"], [\"type\", \"text\", \"name\", \"ip\", 3, \"ngModel\"], [\"type\", \"submit\", 1, \"ui\", \"submit\", \"large\", \"grey\", \"button\", \"right\", \"floated\"], [1, \"ui\", \"negative\", \"message\"], [\"alt\", \"profile image\", 1, \"ui\", \"image\", 3, \"src\"], [\"src\", \"assets/profile-placeholder.png\", \"alt\", \"profile image\", 1, \"ui\", \"image\"]],\n    template: function ProfileComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ProfileComponent_div_0_Template, 63, 21, \"div\", 0);\n        i0.ɵɵpipe(1, \"async\");\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(1, 1, ctx.item));\n      }\n    },\n    styles: [\".add-form-container[_ngcontent-%COMP%]{max-width:960px;margin:50px auto}.ui.form[_ngcontent-%COMP%]   select.specialty[_ngcontent-%COMP%]{height:55px}.profile-image[_ngcontent-%COMP%]{padding:20px}.profile-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.file-input[_ngcontent-%COMP%]{display:none}.upload-button[_ngcontent-%COMP%]{float:right;margin-top:20px}\"]\n  });\n  return ProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}